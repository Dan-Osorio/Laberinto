<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Ontología: El Laberinto de la Soledad</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style type="text/css">
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #0d1117;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        #grafo-canvas {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
        }
        
        /* Título */
        #titulo {
            position: absolute;
            top: 25px;
            left: 25px;
            color: rgba(255,255,255,0.9);
            z-index: 10;
            pointer-events: none;
            text-shadow: 0px 2px 4px rgba(0,0,0,0.8);
        }
        #titulo h1 { margin: 0; font-size: 26px; font-weight: 300; letter-spacing: 2px;}
        #titulo p { margin: 5px 0 0 0; font-size: 13px; color: #8b9eb0;}

        /* Leyenda */
        #leyenda {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: rgba(15, 20, 25, 0.85);
            padding: 20px;
            border-radius: 10px;
            color: #d1d5db;
            z-index: 10;
            border: 1px solid #30363d;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        #leyenda h3 {
            margin: 0 0 15px 0; font-size: 14px; text-transform: uppercase;
            letter-spacing: 1.5px; color: #ffffff; border-bottom: 1px solid #30363d; padding-bottom: 8px;
        }
        .item-leyenda { display: flex; align-items: center; margin-bottom: 10px; font-size: 13px; }
        .item-leyenda:last-child { margin-bottom: 0; }
        .color-dot { width: 14px; height: 14px; border-radius: 50%; display: inline-block; margin-right: 12px; }

        /* Panel de Información de Conceptos (NUEVO) */
        #info-panel {
            position: absolute;
            top: 100px;
            left: -400px; /* Oculto por defecto (fuera de pantalla) */
            width: 320px;
            background: rgba(15, 20, 25, 0.95);
            padding: 25px;
            border-radius: 10px;
            color: #e6edf3;
            z-index: 20;
            border: 1px solid #444c56;
            box-shadow: 5px 5px 20px rgba(0,0,0,0.7);
            backdrop-filter: blur(10px);
            transition: left 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* Animación suave */
        }
        #info-panel.visible { left: 25px; } /* Clase que lo hace aparecer */
        #info-title {
            margin: 0 0 15px 0; font-size: 22px; color: #58a6ff; font-weight: 600;
            border-bottom: 1px solid #30363d; padding-bottom: 10px;
        }
        #info-text { font-size: 15px; line-height: 1.6; color: #c9d1d9; }
        #close-btn {
            position: absolute; top: 15px; right: 15px; cursor: pointer; color: #8b9eb0;
            font-size: 18px; font-weight: bold;
        }
        #close-btn:hover { color: #ffffff; }

    </style>
</head>
<body>

<div id="titulo">
    <h1>EL LABERINTO DE LA SOLEDAD</h1>
    <p>Red Ontológica</p>
</div>

<div id="leyenda">
    <h3>Ejes Temáticos</h3>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #d32f2f;"></span> Núcleo Existencial</div>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #7b1fa2;"></span> El Pachuco</div>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #1976d2;"></span> Máscaras Mexicanas</div>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #fbc02d;"></span> Fiesta y Muerte</div>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #e64a19;"></span> Hijos de la Malinche</div>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #388e3c;"></span> Historia</div>
    <div class="item-leyenda"><span class="color-dot" style="background-color: #0097a7;"></span> Filosofía</div>
</div>

<div id="info-panel">
    <div id="close-btn" onclick="cerrarPanel()">✖</div>
    <h2 id="info-title">Concepto</h2>
    <div id="info-text">Selecciona un nodo para ver su definición.</div>
</div>

<div id="grafo-canvas"></div>

<script type="text/javascript">
    // 0. DICCIONARIO DE CONCEPTOS (Basado en el libro)
    const diccConceptos = {
        1: "Sujeto central del ensayo, caracterizado por su actitud defensiva, su dualidad y su profunda sensación de aislamiento.",
        2: "Estado existencial primario del mexicano. No es solo estar solo, sino sentirse huérfano de su historia y origen.",
        50: "Metáfora de la búsqueda de identidad y el enredo histórico y psicológico en el que se encuentra atrapado el mexicano.",
        3: "Figura del joven mexicoamericano de los años 40 que rechaza tanto su origen mexicano como su adopción estadounidense.",
        4: "Pérdida de las raíces culturales que lleva a vivir en un extremo existencial suspendido en la nada.",
        5: "Espacio geográfico y mental de choque cultural, hibridación y permanente marginación.",
        6: "Símbolo del pragmatismo, el optimismo y la confianza ingenua en el futuro, contrastante con el pesimismo histórico mexicano.",
        7: "Uso del lenguaje y la vestimenta (zoot suit) no para asimilarse a la sociedad, sino para destacar, incomodar y desafiar.",
        8: "Necesidad profunda de definirse a uno mismo ante la ausencia de un asidero cultural firme.",
        9: "Mecanismos de defensa psicológica y social que el mexicano usa para protegerse y ocultar su vulnerabilidad.",
        10: "Cierre emocional frente al mundo. La idea de que abrirse es 'rajarse', es mostrar debilidad y permitir ser vulnerado.",
        11: "Expresión de poder y agresividad que en el fondo enmascara una tremenda inseguridad y temor a la debilidad.",
        12: "Vergüenza del propio cuerpo, de los sentimientos y de la intimidad, ligado al temor constante de ser invadido por el otro.",
        13: "Uso estricto de la cortesía, las fórmulas y las reglas sociales para mantener una distancia infranqueable con los demás.",
        14: "El acto de ignorar, hacer menos o anular la existencia del otro ('don Nadie') para inflar y proteger el propio ego.",
        15: "Aparentar lo que no se es. Actuar una ficción impuesta hasta que la mentira se convierte en una segunda naturaleza.",
        16: "Forma de ocultamiento trágico más que un simple engaño malicioso; el mexicano miente para no revelar su ser verdadero.",
        17: "Aceptación pasiva y estoica del sufrimiento y la derrota como parte ineludible del destino.",
        18: "El único momento donde el mexicano se abre, explota, gasta lo que no tiene y rompe temporalmente su duro hermetismo.",
        19: "La fiesta entendida como un regreso al caos originario, donde las reglas, la moral y las jerarquías se suspenden momentáneamente.",
        20: "Gasto ritual y excesivo en celebraciones que muestra el desprecio mexicano por la riqueza acumulada y el tiempo lineal.",
        21: "Conexión intensa pero pasajera entre los individuos que por un instante de embriaguez olvidan su soledad atávica.",
        22: "Presencia constante en la psique mexicana; no se le teme en público, se le festeja, acaricia y desafía, aunque en el fondo aterra.",
        23: "Actitud en la que la vida misma carece de valor intrínseco si no está anclada a algo absoluto, resultando en un desafío constante.",
        24: "Se hacen calaveras, panes y dulces de la muerte en un intento irónico por domesticar y burlar el miedo a la desaparición.",
        25: "Doña Marina, símbolo paradójico de la madre indígena fascinada, seducida o violentada por el conquistador extranjero.",
        26: "La figura mítica de la madre violada, abierta por la fuerza. Representa la herida original y vergonzosa de la Conquista.",
        27: "El macho violento, el conquistador agresivo, el que rompe y 'abre'. Figura de poder que el mexicano admira íntimamente y teme.",
        28: "Resultado de la dialéctica de poder (chingón contra chingada) que rige brutalmente las relaciones sociales y políticas.",
        29: "El choque sangriento y desigual entre españoles e indígenas que marca el doloroso e irreconciliable nacimiento del mestizo.",
        30: "Sentimiento profundo de no pertenecer legítimamente ni a España ni al mundo indígena puro; ser el 'hijo de la nada'.",
        31: "La evolución de México, vista por Paz no como un progreso lineal, sino como una búsqueda constante de forma, sentido y pertenencia.",
        32: "Las raíces originarias de México, caracterizadas por una visión cósmica, teocrática y trágica del universo.",
        33: "La idea prehispánica de que el universo es inestable y necesita alimentarse con sangre y muerte para subsistir y mantener su orden.",
        34: "Ruptura violenta del mundo indígena, sentida no solo como derrota militar, sino como el abandono incomprensible de los dioses antiguos.",
        35: "Refugio espiritual adoptado tras la orfandad de la conquista; ofrece un consuelo, un orden universal y una nueva madre (la Virgen).",
        36: "El largo periodo colonial de orden cerrado y escolástico; una paz aparente y superficial construida sobre ruinas humeantes.",
        37: "Ruptura violenta con el orden protector y materno de España; un intento inmaduro e idealista de ser de pronto 'modernos'.",
        38: "Esfuerzo radical de Juárez y los liberales por extirpar el pasado tradicional católico e imponer leyes universales, racionales pero abstractas.",
        39: "Explosión repentina de la realidad mexicana que había sido reprimida; el pueblo buscando su verdadero rostro en el fuego y el instinto.",
        40: "Símbolo puro de la Revolución: representa el arraigo a la tierra y la tradición comunal frente al destructivo avance de la modernidad.",
        41: "El deseo nostálgico del mexicano de recuperar su origen material y espiritual del cual fue despojado históricamente.",
        42: "El papel histórico de los intelectuales, filósofos y artistas mexicanos en tratar de dar forma, voz y sentido a una identidad dispersa.",
        43: "Narrativas y símbolos profundos (como la Virgen o la Chingada) que estructuran el alma nacional mucho más que la razón o la ciencia.",
        44: "La dolorosa condición económica y periférica de México frente a las potencias del mundo, evidenciada por la historia.",
        45: "El anhelo auténtico de salir de la soledad; no mediante el grito ciego de la fiesta, sino a través del amor y la apertura genuina al otro.",
        46: "La esperanza final propuesta por Paz: sanar la herida histórica, reconciliarse con el propio ser y superar el laberinto defensivo.",
        47: "La gran conclusión: descubrir que la soledad del mexicano es en el fondo la misma crisis existencial del hombre moderno en cualquier parte del mundo.",
        48: "Filosofía importada durante el Porfiriato que pretendió civilizar a México pero falló por no entender las verdaderas raíces y mitos del país.",
        49: "El saldo amargo de la Revolución institucionalizada; la creación de formas burocráticas que no lograron curar la profunda orfandad de la sociedad."
    };

    // 1. DEFINICIÓN DE NODOS
    var nodesDataset = new vis.DataSet([
        { id: 1, label: 'El Mexicano', value: 35, group: 'nucleo' }, { id: 2, label: 'La Soledad', value: 35, group: 'nucleo' }, { id: 50, label: 'El Laberinto\n(La Existencia)', value: 25, group: 'nucleo' },
        { id: 3, label: 'El Pachuco', value: 18, group: 'pachuco' }, { id: 4, label: 'Desarraigo', value: 12, group: 'pachuco' }, { id: 5, label: 'La Frontera', value: 10, group: 'pachuco' },
        { id: 6, label: 'Norteamérica\n(Pragmatismo)', value: 12, group: 'pachuco' }, { id: 7, label: 'Rebeldía Estética', value: 9, group: 'pachuco' }, { id: 8, label: 'Búsqueda de\nIdentidad', value: 14, group: 'pachuco' },
        { id: 9, label: 'Máscaras', value: 20, group: 'mascaras' }, { id: 10, label: 'Hermetismo', value: 16, group: 'mascaras' }, { id: 11, label: 'Machismo', value: 15, group: 'mascaras' },
        { id: 12, label: 'El Pudor', value: 10, group: 'mascaras' }, { id: 13, label: 'Las Formas\n(Cortesía)', value: 12, group: 'mascaras' }, { id: 14, label: 'El Ninguneo', value: 14, group: 'mascaras' },
        { id: 15, label: 'Simulación', value: 13, group: 'mascaras' }, { id: 16, label: 'Mentira', value: 9, group: 'mascaras' }, { id: 17, label: 'Resignación', value: 10, group: 'mascaras' },
        { id: 18, label: 'La Fiesta', value: 20, group: 'fiesta' }, { id: 19, label: 'Caos / Ruptura', value: 12, group: 'fiesta' }, { id: 20, label: 'Despilfarro', value: 10, group: 'fiesta' },
        { id: 21, label: 'Comunión\nEfímera', value: 15, group: 'fiesta' }, { id: 22, label: 'La Muerte', value: 22, group: 'fiesta' }, { id: 23, label: 'Desprecio a\nla Vida', value: 12, group: 'fiesta' },
        { id: 24, label: 'Fascinación / Burla', value: 11, group: 'fiesta' }, { id: 25, label: 'La Malinche', value: 20, group: 'malinche' }, { id: 26, label: 'La Chingada', value: 22, group: 'malinche' },
        { id: 27, label: 'El Chingón', value: 16, group: 'malinche' }, { id: 28, label: 'Violencia', value: 14, group: 'malinche' }, { id: 29, label: 'Origen\nTraumático', value: 16, group: 'malinche' },
        { id: 30, label: 'Orfandad', value: 18, group: 'malinche' }, { id: 31, label: 'La Historia', value: 18, group: 'historia' }, { id: 32, label: 'Culturas\nPrecolombinas', value: 13, group: 'historia' },
        { id: 33, label: 'Sacrificio Cósmico', value: 11, group: 'historia' }, { id: 34, label: 'La Conquista', value: 17, group: 'historia' }, { id: 35, label: 'Catolicismo', value: 14, group: 'historia' },
        { id: 36, label: 'Nueva España', value: 11, group: 'historia' }, { id: 37, label: 'La Independencia', value: 12, group: 'historia' }, { id: 38, label: 'La Reforma', value: 12, group: 'historia' },
        { id: 39, label: 'La Revolución', value: 19, group: 'historia' }, { id: 40, label: 'Emiliano Zapata', value: 12, group: 'historia' }, { id: 41, label: 'Retorno a\nla Tierra', value: 10, group: 'historia' },
        { id: 42, label: 'Inteligencia\nMexicana', value: 12, group: 'filosofia' }, { id: 43, label: 'El Mito', value: 11, group: 'filosofia' }, { id: 44, label: 'Subdesarrollo', value: 9, group: 'filosofia' },
        { id: 45, label: 'Comunión\nVerdadera', value: 16, group: 'filosofia' }, { id: 46, label: 'Redención', value: 14, group: 'filosofia' }, { id: 47, label: 'Universalidad', value: 12, group: 'filosofia' },
        { id: 48, label: 'Positivismo', value: 8, group: 'filosofia' }, { id: 49, label: 'Promesas\nIncumplidas', value: 10, group: 'filosofia' }
    ]);

    // 2. DEFINICIÓN DE ARISTAS
    var edgesDataset = new vis.DataSet([
        { from: 1, to: 2, value: 15 }, { from: 1, to: 50, value: 10 }, { from: 2, to: 50, value: 12 }, { from: 1, to: 3, value: 6 }, { from: 1, to: 9, value: 12 }, { from: 1, to: 18, value: 10 }, { from: 1, to: 25, value: 12 }, { from: 1, to: 31, value: 10 },
        { from: 3, to: 4, value: 8 }, { from: 3, to: 5, value: 7 }, { from: 5, to: 6, value: 6 }, { from: 3, to: 7, value: 5 }, { from: 3, to: 8, value: 9 }, { from: 4, to: 2, value: 8 },
        { from: 9, to: 10, value: 10 }, { from: 9, to: 11, value: 9 }, { from: 9, to: 12, value: 7 }, { from: 9, to: 13, value: 8 }, { from: 10, to: 2, value: 12 }, { from: 14, to: 10, value: 6 }, { from: 9, to: 15, value: 7 }, { from: 15, to: 16, value: 5 }, { from: 17, to: 10, value: 6 }, { from: 11, to: 27, value: 8 },
        { from: 18, to: 19, value: 7 }, { from: 18, to: 20, value: 6 }, { from: 18, to: 21, value: 9 }, { from: 21, to: 2, value: 8, dashes: true }, { from: 1, to: 22, value: 11 }, { from: 22, to: 23, value: 8 }, { from: 22, to: 24, value: 7 }, { from: 18, to: 22, value: 8 },
        { from: 25, to: 26, value: 15 }, { from: 26, to: 27, value: 10 }, { from: 26, to: 29, value: 12 }, { from: 27, to: 28, value: 9 }, { from: 29, to: 30, value: 14 }, { from: 30, to: 2, value: 15 }, { from: 34, to: 25, value: 12 },
        { from: 31, to: 32, value: 8 }, { from: 32, to: 33, value: 7 }, { from: 31, to: 34, value: 12 }, { from: 34, to: 35, value: 9 }, { from: 35, to: 36, value: 8 }, { from: 36, to: 37, value: 7 }, { from: 37, to: 38, value: 7 }, { from: 38, to: 39, value: 10 }, { from: 39, to: 40, value: 8 }, { from: 40, to: 41, value: 7 }, { from: 39, to: 49, value: 6 },
        { from: 42, to: 48, value: 5 }, { from: 42, to: 8, value: 7 }, { from: 2, to: 45, value: 10, dashes: true }, { from: 45, to: 46, value: 8 }, { from: 46, to: 47, value: 9 }, { from: 1, to: 47, value: 6 }, { from: 49, to: 44, value: 6 }, { from: 44, to: 43, value: 5 }
    ]);

    // 3. CONFIGURACIÓN VISUAL
    var container = document.getElementById('grafo-canvas');
    var data = { nodes: nodesDataset, edges: edgesDataset };
    var options = {
        nodes: {
            shape: 'dot', font: { size: 14, face: 'Tahoma', color: '#ffffff', strokeWidth: 2, strokeColor: '#000000' },
            shadow: { enabled: true, color: 'rgba(255,255,255,0.1)', size: 10, x: 0, y: 0 }, borderWidth: 2, borderWidthSelected: 4
        },
        edges: { width: 1.5, color: { color: '#3a4a5a', highlight: '#8cb1d9', hover: '#8cb1d9', opacity: 0.6 }, smooth: { type: 'curvedCW', roundness: 0.2 }, arrows: { to: { enabled: true, scaleFactor: 0.5 } } },
        groups: {
            nucleo:   { color: { background: '#d32f2f', border: '#b71c1c' } }, pachuco:  { color: { background: '#7b1fa2', border: '#4a148c' } },
            mascaras: { color: { background: '#1976d2', border: '#0d47a1' } }, fiesta:   { color: { background: '#fbc02d', border: '#f57f17' }, font: { color: '#ffffff' } },
            malinche: { color: { background: '#e64a19', border: '#bf360c' } }, historia: { color: { background: '#388e3c', border: '#1b5e20' } },
            filosofia:{ color: { background: '#0097a7', border: '#006064' } }
        },
        physics: { forceAtlas2Based: { gravitationalConstant: -150, centralGravity: 0.015, springLength: 120, springConstant: 0.04 }, maxVelocity: 50, solver: 'forceAtlas2Based', timestep: 0.35, stabilization: { iterations: 150 } },
        interaction: { hover: true, tooltipDelay: 200, zoomView: true, dragView: true }
    };
    
    // Iniciar Grafo
    var network = new vis.Network(container, data, options);
    network.once("stabilizationIterationsDone", function() { network.fit({ animation: { duration: 1500, easingFunction: "easeOutQuart" } }); });

    // --- LÓGICA DEL PANEL DE INFORMACIÓN AL HACER CLIC ---
    var panel = document.getElementById('info-panel');
    var panelTitle = document.getElementById('info-title');
    var panelText = document.getElementById('info-text');

    network.on('click', function (propiedades) {
        var idsSeleccionados = propiedades.nodes; // Lista de nodos clickeados

        if (idsSeleccionados.length > 0) {
            var idNodo = idsSeleccionados[0]; // Obtener el ID del primer nodo
            var nodoDatos = nodesDataset.get(idNodo); // Extraer los datos del nodo
            
            // Actualizar el título limpiando los saltos de línea (\n)
            panelTitle.innerText = nodoDatos.label.replace('\n', ' '); 
            
            // Buscar la definición en nuestro diccionario. Si no existe, poner algo por defecto.
            if(diccConceptos[idNodo]) {
                panelText.innerText = diccConceptos[idNodo];
            } else {
                panelText.innerText = "Concepto clave en la estructura de El Laberinto de la Soledad.";
            }

            // Cambiar el color del título según el grupo al que pertenece el nodo
            panelTitle.style.color = options.groups[nodoDatos.group].color.background;

            // Mostrar el panel añadiendo la clase 'visible'
            panel.classList.add('visible');
        } else {
            // Si el usuario da clic al espacio en blanco oscuro, se esconde el panel
            cerrarPanel();
        }
    });

    // Función para el botón X
    function cerrarPanel() {
        panel.classList.remove('visible');
    }

</script>
</body>
</html>
